(()=>{"use strict";var t={d:(e,c)=>{for(var n in c)t.o(c,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:c[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{Y:()=>ot,D:()=>rt});const e=async(t,{method:e="get",callback:c,body:n,headers:a})=>{try{const r={method:e};n&&(r.body=JSON.stringify(n)),a&&(r.headers=a);const o=await fetch(t,r);if(o.ok){const t=await o.json();return void(c&&c(null,t))}throw new Error(`Ошибка ${o.status}: ${o.statusText}`)}catch(t){c(t)}},c={set:(t,e)=>{const c=JSON.parse(sessionStorage.getItem("shop")),n=c?{...c,[t]:e}:{[t]:e};sessionStorage.setItem("shop",JSON.stringify(n))},get:t=>JSON.parse(sessionStorage.getItem("shop"))[t],clear:()=>{sessionStorage.removeItem("shop")}},n=document.querySelector(".header__menu-button"),a=document.querySelector(".header__button-icon"),r=document.querySelector(".header__menu-box"),o=document.querySelector(".header__menu-overlay"),s=document.querySelector(".header__navigation-link_type_cart"),d=document.querySelector(".header__cart-counter"),i=document.getElementById("categories-header"),l=document.getElementById("categories-footer"),_=["Смартфоны","Ноутбуки","Ювелирные изделия","Одежда","Бытовая техника","Бытовая химия","Книги и журналы","Домашний текстиль","Электроника","Косметика"],u=(t,e="header")=>{if("header"!==e&&"footer"!==e)return;const n=document.createElement("li");n.className=`navigation-block__item navigation-block__item_position_${e}`;const a=document.createElement("a");return a.classList.add("navigation-block__link"),a.href="catalog.html",a.innerText=t,a.addEventListener("click",(()=>(t=>c.set("category",t))(t))),n.append(a),n},p=()=>{e(ot+"user",{callback:(t,e)=>{if(t)return void console.warn(t);const c=e.cart.reduce(((t,e)=>t+Number(e.count)),0);s.setAttribute("aria-label",`Ссылка на вашу корзину. Количество товаров: ${c}`),d.textContent=`${c}`}})},m=(t,e,c)=>{const{title:n,mainBlock:a,dayNum:r,dayParam:o,hourNum:s,hourParam:d,minNum:i,minParam:l}=(t=>{const e=document.createElement("p");e.classList.add("block-one__text"),e.textContent="До конца акции:";const c=document.createElement("div");c.classList.add("block-one__timer");const n=t=>{const e=document.createElement("div");e.classList.add("block-one__timer-item",t);const c=document.createElement("p");c.classList.add("block-one__timer-value");const n=document.createElement("p");return n.classList.add("block-one__timer-parameter"),e.append(c,n),e.value=c,e.parameter=n,e},a=n("block-one__timer-item_type_days"),r=n("block-one__timer-item_type_hours"),o=n("block-one__timer-item_type_minutes");return c.append(a,r,o),t.append(e,c),{title:e,mainBlock:c,dayNum:a.value,dayParam:a.parameter,hourNum:r.value,hourParam:r.parameter,minNum:o.value,minParam:o.parameter}})(t),_=()=>{const t=(()=>{const t=new Date(`${e} GMT${c}:00`).getTime()-Date.now();return{timeRemaining:t,seconds:Math.floor(t/1e3%60),minutes:Math.floor(t/1e3/60%60),hours:Math.floor(t/1e3/60/60%24),days:Math.floor(t/1e3/60/60/24)}})(),u=t=>({style:"unit",unit:t,unitDisplay:"long",maximumSignificantDigits:"2"}),p=new Intl.NumberFormat("ru",u("day")),m=new Intl.NumberFormat("ru",u("hour")),b=new Intl.NumberFormat("ru",u("minute")),h=new Intl.NumberFormat("ru",u("second"));r.textContent=t.days<10?"0"+t.days:t.days,o.textContent=p.format(t.days).slice(2).trim(),s.textContent=t.hours<10?"0"+t.hours:t.hours,d.textContent=m.format(t.hours).slice(2).trim(),i.textContent=t.minutes<10?"0"+t.minutes:t.minutes,l.textContent=b.format(t.minutes).slice(2).trim();const v=setTimeout(_,1e3);t.timeRemaining<864e5&&(r.textContent=t.hours<10?"0"+t.hours:t.hours,o.textContent=m.format(t.hours).slice(2).trim(),s.textContent=t.minutes<10?"0"+t.minutes:t.minutes,d.textContent=b.format(t.minutes).slice(2).trim(),i.textContent=t.seconds<10?"0"+t.seconds:t.seconds,l.textContent=h.format(t.seconds).slice(2).trim()),t.timeRemaining<=0&&(clearTimeout(v),r.textContent="00",s.textContent="00",i.textContent="00",n.remove(),a.remove())};_()},b=t=>{const e=document.querySelector("[data-timer-deadline]");return e?m(e,e.dataset.timerDeadline,t):null},h=document.querySelector(".products-block__list"),v=()=>{const t=document.createElement("li");return t.classList.add("products-block__skeleton","skeleton"),t},g=t=>{const e=document.createElement("li");e.classList.add("products-block__item");const n=document.createElement("a");n.classList.add("products-block__link","product-card"),n.href="product.html";const a=t.discount?`Карточка товара: ${t.title}. Старая цена ${t.price} рублей. Новая цена ${Math.round(t.price*(1-.01*t.discount))} рублей. Скидка ${t.discount}%`:`Карточка товара: ${t.title}. Цена ${t.price} рублей.`;return n.ariaLabel=a,n.insertAdjacentHTML("afterbegin",`\n    <div class="product-card__image-container">\n      <picture>\n        <source srcset="${rt}${t.image}" type="image/avif">\n        <source srcset="${rt}${t.image}" type="image/webp">\n        <img class="product-card__image" src="${rt}${t.image}" alt="Изображение товара" width="428" height="295">\n      </picture>\n      ${t.discount?`<p class="profitable__discount-marker discount-marker discount-marker_position_bottom-left">-${t.discount}%</p>`:""}\n    </div>\n\n    <div class="product-card__price-block">\n      <p class="product-card__price">${Math.round(t.price*(1-.01*t.discount))} ₽</p>\n      ${t.discount?`<p class="product-card__price-old">${t.price} ₽</p>`:""}\n    </div>\n     \n    <h4 class="product-card__product-name">${t.title}</h4>\n  `),n.addEventListener("click",(()=>{return e=t.id,c.set("product",e);var e})),e.append(n),e},k=()=>{(()=>{const t=[];for(let e=0;e<12;e++)t.push(v());h.append(...t)})();(t=>{const e=document.querySelector(".products-block__header_page_catalog");e&&(e.textContent=t)})(c.get("category")),e(ot+"goods/category/Cмартфоны",{callback:(t,e)=>{t?console.warn(t):(t=>{h.innerHTML="";const e=t.map((t=>g(t)));h.append(...e)})(e)}})},y=document.querySelector(".product__title"),L=document.querySelector(".product__content"),x=t=>{const c=document.querySelector(".product__buy-btn");c.addEventListener("click",(()=>{c.classList.add("product__buy-btn_status_await"),c.disabled=!0,((t,c)=>{e(ot+"user",{method:"POST",body:{id:t.id,image:t.image,title:t.title,price:t.discount?String(Math.round(Number(t.price)*(1-.01*Number(t.discount)))):Math.round(t.price),oldPrice:t.discount?String(Math.round(Number(t.price))):null,extra:t.extra||null,count:"1",isCheckedForOrder:!0,maxCount:t.count},callback:(t,e)=>{t&&(console.warn(t),alert("Произошла ошибка"),c.classList.remove("product__buy-btn_status_await"),c.disabled=!1),alert("Товар добавлен"),c.classList.remove("product__buy-btn_status_await"),c.disabled=!1,p()}})})(t,c)}))},f=()=>{y.classList.add("product__skeleton","product__skeleton_title","skeleton"),(()=>{const t=document.createElement("div");t.classList.add("product__skeleton","product__skeleton_image","skeleton");const e=document.createElement("div");e.classList.add("product__skeleton","product__skeleton_info","skeleton");const c=document.createElement("div");c.classList.add("product__skeleton","product__skeleton_description","skeleton"),L.append(t,e,c)})()},C=()=>{f();const t=c.get("product");e(ot+"goods/"+t,{callback:(t,e)=>{var c;t&&(console.warn(t),alert("Произошла ошибка")),y.classList.remove("product__skeleton","product__skeleton_title","skeleton"),L.innerHTML="",c=e,y.textContent=c.title,L.insertAdjacentHTML("beforeend",`\n    <div class="product__image-container">\n      <picture>\n        <source srcset="${rt}${c.image}" type="image/avif">\n        <source srcset="${rt}${c.image}" type="image/webp">\n        <img class="product__image" src="${rt}${c.image}" alt="Фотография ${c.title}" \n         width="757" height="427">\n      </picture>\n      ${c.discount?`<p class="profitable__discount-marker discount-marker discount-marker_position_top-right" aria-label="Скидка">-${c.discount}%</p>`:""}\n      \n    </div>\n\n    <div class="product__info material-card">\n\n      <div class="product__price-block">\n        ${c.discount?`<p class="product__price" aria-label="Новая цена">${Math.round(c.price*(1-.01*c.discount))} ₽</p>\n             <p class="product__price-old" aria-label="Старая цена">${c.price} ₽</p>`:`<p class="product__price" aria-label="Цена">${c.price} ₽</p>`}\n        <p class="product__credit">В кредит от 5600 ₽</p>\n      </div>\n\n      <div class="product__actions-block">\n        <button class="product__buy-btn button" type="button">Добавить в корзину</button>\n        <button class="product__favorites-btn" type="button" aria-label="Добавить в избранное">\n          <svg width="33" height="33" viewBox="0 0 33 33" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n            <g clip-path="url(#clip0_2908_1178)">\n              <path d="M22.6875 4.125C20.295 4.125 17.9987 5.23875 16.5 6.99875C15.0012 5.23875 12.705 4.125 10.3125 4.125C6.0775 \n              4.125 2.75 7.4525 2.75 11.6875C2.75 16.885 7.425 21.12 14.5062 27.555L16.5 29.3563L18.4937 27.5413C25.575 21.12 \n              30.25 16.885 30.25 11.6875C30.25 7.4525 26.9225 4.125 22.6875 4.125ZM16.6375 25.5062L16.5 25.6437L16.3625 \n              25.5062C9.8175 19.58 5.5 15.6613 5.5 11.6875C5.5 8.9375 7.5625 6.875 10.3125 6.875C12.43 6.875 14.4925 8.23625 \n              15.2212 10.12H17.7925C18.5075 8.23625 20.57 6.875 22.6875 6.875C25.4375 6.875 27.5 8.9375 27.5 11.6875C27.5 15.6613 \n              23.1825 19.58 16.6375 25.5062Z" fill="currentColor"/>\n            </g>\n            <defs>\n              <clipPath id="clip0_2908_1178">\n                <rect width="33" height="33" fill="none"/>\n              </clipPath>\n            </defs>\n          </svg>\n        </button>\n      </div>\n\n      <div class="product__delivery-block">\n        <div class="product__delivery">\n          <p class="product__delivery-subtitle">Доставка</p>\n          <p class="product__delivery-text">1-3 января</p>   \n        </div>\n        <div class="product__seller">\n          <p class="product__delivery-subtitle">Продавец</p>\n          <p class="product__delivery-text">ShopOnline</p>   \n        </div>\n      </div>\n\n      <button class="product__subscribe" type="button">\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n          <path d="M19 13.586V10C19 6.783 16.815 4.073 13.855 3.258C13.562 2.52 12.846 2 12 2C11.154 2 10.438 2.52 10.145 3.258C7.185 4.074 5 6.783 5 10V13.586L3.293 15.293C3.19996 15.3857 3.12617 15.4959 3.07589 15.6172C3.0256 15.7386 2.99981 15.8687 3 16V18C3 18.2652 3.10536 18.5196 3.29289 18.7071C3.48043 18.8946 3.73478 19 4 19H20C20.2652 19 20.5196 18.8946 20.7071 18.7071C20.8946 18.5196 21 18.2652 21 18V16C21.0002 15.8687 20.9744 15.7386 20.9241 15.6172C20.8738 15.4959 20.8 15.3857 20.707 15.293L19 13.586ZM19 17H5V16.414L6.707 14.707C6.80004 14.6143 6.87383 14.5041 6.92412 14.3828C6.9744 14.2614 7.00019 14.1313 7 14V10C7 7.243 9.243 5 12 5C14.757 5 17 7.243 17 10V14C17 14.266 17.105 14.52 17.293 14.707L19 16.414V17ZM12 22C12.6193 22.0008 13.2235 21.8086 13.7285 21.4502C14.2335 21.0917 14.6143 20.5849 14.818 20H9.182C9.38566 20.5849 9.76648 21.0917 10.2715 21.4502C10.7765 21.8086 11.3807 22.0008 12 22V22Z" fill="currentColor"/>\n        </svg><span class="product__subscribe-text">Узнать о снижении цены</span>\n      </button>\n\n    </div>\n\n    <div class="product__description">\n      <h3 class="product__description-title">Описание:</h3>\n      <p class="product__description-text">${c.description}</p>\n    </div>\n  `),x(e)}})},E=document.querySelector(".cart__goods-number"),w=document.querySelector(".cart__goods-actions"),$=document.querySelector(".cart__goods-list"),S=document.querySelector(".cart__card_type_delivery"),H=document.querySelector(".cart__delivery-info"),M=document.querySelector(".cart__card_type_total"),P=document.querySelector(".cart__total-container"),A=t=>new Intl.NumberFormat("fr-FR").format(t),N=t=>t.split("").filter((t=>Number.isInteger(+t))).join("").replace(/\s/g,""),T=t=>c.set("product",t),q=t=>{const e=document.querySelector(".header__cart-counter"),c=t.cart.reduce(((t,e)=>t+Number(e.count)),0);e.textContent=`${c}`},j=t=>E.textContent=t.reduce(((t,e)=>t+Number(e.count)),0)+"",V=t=>{const e=document.createElement("div");return e.classList.add("await"),e.insertAdjacentHTML("beforeend",'\n    <span class="await-loader"></span>\n  '),t.classList.add("await-container"),t.append(e),e},O=t=>{t.parentElement.classList.remove("await"),t.remove()},B=()=>{P.classList.add("hidden"),M.insertAdjacentHTML("beforeend",'\n    <div class="cart__total-empty">\n      <p class="cart__empty-header">Товары отсутствут</p>\n      <p class="cart__text">Добавьте новые товары в корзину, или активируйте уже имеющиеся.</p>\n      <a class="cart__empty-link" href="catalog.html">Перейти в каталог</a>\n    </div>\n  ')},I=()=>{S.classList.add("hidden"),$.insertAdjacentHTML("beforeend",'\n    <p class="cart__text">Ваша корзина пуста</p>\n  '),B()},F=()=>{const t=document.querySelector(".cart__total-empty");t&&t.remove(),P.classList.contains("hidden")&&P.classList.remove("hidden")},Z=()=>{const t=document.querySelectorAll(".cart__product-checkbox");return Array.from(t)},D=(t,e,c)=>{if(t.every((t=>!1===t[`${c}`])))return e.disabled=!0,void e.classList.add("cart__delete-btn_disabled");e.disabled=!1,e.classList.contains("cart__delete-btn_disabled")&&e.classList.remove("cart__delete-btn_disabled")},J=(t,e,c,n,a)=>{const r=t.filter((t=>!0===t.checked));if(!r.length)return void B();F();const o=r.map((t=>t.closest(".cart__goods-item"))),s=o.map((t=>(t=>{const e=Array.from(t.lastElementChild.previousElementSibling.children),c=Array.from(t.lastElementChild.previousElementSibling.previousElementSibling.children),n=Number(c[1].textContent);let a=0,r=0;e.forEach((t=>{t.classList.contains("cart__goods-price")?a+=Number(N(t.textContent))*n:t.classList.contains("cart__goods-discount")&&(r+=Number(N(t.textContent))*n)}));const o=r?r-a:0;return r||(r+=a),{currentPrice:a,count:n,oldPrice:r,discount:o}})(t))).reduce(((t,e)=>(t.currentPrice+=e.currentPrice,t.count+=e.count,t.oldPrice+=e.oldPrice,e.discount&&(t.discount+=e.discount),t)),{currentPrice:0,count:0,oldPrice:0,discount:0});var d;((t,e,c,n,a)=>{e.textContent=t.currentPrice,c.textContent=t.count,n.textContent=t.oldPrice,a.textContent=t.discount})({currentPrice:A((d=s).currentPrice)+" ₽",count:`Товары, ${d.count}  шт.`,oldPrice:`${A(d.oldPrice)} ₽`,discount:`${A(d.discount)} ₽`},e,c,n,a)},R=(t,e)=>t.forEach((t=>t.checked=e)),z=(t,e)=>t.every((t=>!0===t[`${e}`])),G=(t,e)=>{t.checked=z(e,"checked")},W=(t,c,n,a,r,o,s,d,i,l)=>{if("checkbox"!==c)return;if("regular"!==n&&"all"!==n)return;const _=a.map((t=>V(t))),u=V(M);e(ot+"user/cart",{method:"PATCH",body:{id:t,type:c},callback:(t,e)=>{if(t)return console.warn(t),alert("Произошла ошибка"),_.forEach((t=>O(t))),void O(u);_.forEach((t=>O(t))),O(u);const c=Z();var a;"all"===n&&(a=r.checked,R(c,!!a)),"regular"===n&&G(r,c),D(c,o,"checked"),J(c,s,d,i,l)}})},Y=(t,c,n,a,r,o)=>{const s=Z().filter((t=>t.checked)).map((t=>t.closest(".cart__goods-item"))),d=Array.from(s),i=d.map((t=>t.dataset.productid)),l=Array.from(document.querySelectorAll(".cart__delivery-product")).filter((t=>i.includes(t.dataset.productid)));d.forEach((t=>t.classList.add("cart__goods-item_status_await"))),l.forEach((t=>t.classList.add("cart__delivery-product_status_await"))),((t,c,n,a,r,o,s,d,i)=>{e(ot+"user/cart",{method:"DELETE",body:{identifiers:r},callback:(e,r)=>{if(e)return console.warn(e),alert("Произошла ошибка"),n.forEach((t=>t.classList.remove("cart__goods-item_status_await"))),void a.forEach((t=>t.classList.remove("cart__delivery-product_status_await")));n.forEach((t=>t.remove())),a.forEach((t=>t.remove())),q(r),j(r.cart);const l=Z();D(l,t,"checked"),G(c,l),J(l,o,s,d,i)}})})(t,c,d,l,i,n,a,r,o)},K=(t,c,n,a,r,o,s,d,i,l)=>{if("increase"!==a&&"decrease"!==a)return;const _=V(o),u=V(M);e(ot+"user/cart",{method:"PATCH",body:{id:n.id,type:a},callback:(e,o)=>{if(e)return console.warn(e),alert("Произошла ошибка"),O(_),void O(u);O(_),O(u);const p=o.cart.find((t=>t.id===n.id));r.textContent=p.count,q(o),j(o.cart);const m=Z();if(J(m,s,d,i,l),p.count+""=="1"&&"decrease"===a||p.count===p.maxCount&&"increase"===a)return t.disabled=!0,t.classList.add("counter__btn_type_disabled"),c.disabled=!1,void(c.classList.contains("counter__btn_type_disabled")&&c.classList.remove("counter__btn_type_disabled"));t.disabled=!1,t.classList.contains("counter__btn_type_disabled")&&t.classList.remove("counter__btn_type_disabled"),c.disabled=!1,c.classList.contains("counter__btn_type_disabled")&&c.classList.remove("counter__btn_type_disabled")}})},Q=(t,e,c,n,a)=>{const r=document.createElement("label");r.classList.add("cart__goods-all","cart__text","cart__text_weight_bold","cart__text_color_black"),r.setAttribute("for","all");const o=document.createElement("input");o.classList.add("cart__all-checkbox","checkbox"),o.setAttribute("name","all"),o.id="all",o.type="checkbox",o.checked=z(t,"isCheckedForOrder"),r.append(o),r.insertAdjacentHTML("beforeend","Выбрать все");const s=document.createElement("button");return s.classList.add("cart__goods-clearall","cart__delete-btn"),s.type="button",s.setAttribute("aria-label","Удалить выбранные товары из корзины"),s.insertAdjacentHTML("beforeend",'\n    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <g clip-path="url(#clip0_217_1895)">\n       <path d="M19.0214 5.35355L19.1679 5.5H19.375H23.25V7H6.75V5.5H10.625H10.8321L10.9786 5.35355L12.0821 4.25H17.9179L19.0214 5.35355ZM10 25.75C8.90114 25.75 8 24.8489 8 23.75V9.25H22V23.75C22 24.8489 21.0989 25.75 20 25.75H10Z" fill="currentColor" stroke="currentColor"/>\n      </g>\n      <defs>\n        <clipPath id="clip0_217_1895">\n          <rect width="30" height="30" fill="currentColor"/>\n        </clipPath>\n      </defs>\n    </svg>\n  '),s.addEventListener("click",(({target:t})=>((t,e,c,n,a,r)=>{if(confirm("Удалить выбранные товары?"))return Y(t,e,c,n,a,r)})(t,o,e,c,n,a))),D(t,s,"isCheckedForOrder"),o.addEventListener("change",(({target:t})=>((t,e,c,n,a,r)=>{const o=Z().map((t=>t.closest(".cart__goods-item"))),s=o.map((t=>t.dataset.productid)).reduce(((e,c)=>(e.push({id:c,value:t.checked}),e)),[]);W(s,"checkbox","all",o,t,e,c,n,a,r)})(t,s,e,c,n,a))),w.append(r,s),{selectAllCheckbox:o,deleteSelectedButton:s}},U=(t,e,c,n,a)=>{const{selectAllCheckbox:r,deleteSelectedButton:o}=Q(t,e,c,n,a),s=t.map((t=>((t,e,c,n,a,r,o)=>{n||(n=document.querySelector(".cart__total-cost")),a||(a=document.querySelector(".cart__text_content_goods-count")),r||(r=document.querySelector(".cart__text_content_goods-cost")),o||(o=document.querySelector(".cart__text_content_discount-value"));const s=document.createElement("li");s.classList.add("cart__goods-item"),s.setAttribute("data-productid",c.id);const d=document.createElement("label");d.classList.add("cart__goods-product"),d.for="product";const i=document.createElement("input");i.classList.add("cart__product-checkbox","checkbox"),i.name="product",i.id="product",i.type="checkbox",i.checked=c.isCheckedForOrder,i.setAttribute("aria-label",`Выбрать товар ${c.title} для покупки.`),i.addEventListener("change",(({target:d})=>{const i=[{id:c.id,value:d.checked}];return W(i,"checkbox","regular",[s],t,e,n,a,r,o)})),d.append(i),s.append(d);const l=document.createElement("a");l.classList.add("cart__goods-picture","cart__img-container"),l.href="product.html",l.insertAdjacentHTML("beforeend",`\n    <picture>\n      <source srcset="${rt}${c.image}" type="image/avif">\n      <source srcset="${rt}${c.image}" type="image/webp">\n      <img class="cart__goods-image" src="${rt}${c.image}" alt="Изображение товара ${c.title}" width="130" height="130">\n    </picture>\n  `),l.addEventListener("click",(()=>T(c.id))),s.append(l);const _=document.createElement("div");_.classList.add("cart__product-info");const u=document.createElement("a");u.classList.add("cart__product-name"),u.href="product.html",u.textContent=c.title,u.addEventListener("click",(()=>T(c.id))),_.append(u),_.insertAdjacentHTML("beforeend",`\n    <div class="cart__product-about">\n      <p class="cart__text">${c.extra.propOne[0]+": "+c.extra.propOne[1]}</p>\n      <p class="cart__text">${c.extra.propTwo[0]+": "+c.extra.propTwo[1]}</p>\n    </div>\n  `),s.append(_);const p=document.createElement("div");p.classList.add("cart__goods-counter","counter");const m=document.createElement("p");m.classList.add("counter__value"),m.ariaLabel="Текущее количество товара",m.textContent=c.count;const b=document.createElement("button");b.classList.add("counter__btn","counter__btn_type_minus"),b.type="button",b.ariaLabel=`Убавить количество товара на 1. Текуще количество ${c.count}.`,b.textContent="-",b.disabled=c.count+""=="1",c.count+""=="1"&&b.classList.add("counter__btn_type_disabled");const h=document.createElement("button");h.classList.add("counter__btn","counter__btn_type_plus"),h.type="button",h.ariaLabel=`Увеличить количество товара на 1. Текуще количество ${c.count}.`,h.textContent="+",h.disabled=c.count===c.maxCount,c.count===c.maxCount&&h.classList.add("counter__btn_type_disabled"),b.addEventListener("click",(({target:t})=>{K(t,h,c,"decrease",m,s,n,a,r,o)})),h.addEventListener("click",(({target:t})=>{K(t,b,c,"increase",m,s,n,a,r,o)})),p.append(b,m,h),s.append(p),s.insertAdjacentHTML("beforeend",`\n    <div class="cart__goods-right">\n      <p class="cart__goods-price">${A(Math.round(Number(c.price)))} ₽</p>\n      ${c.oldPrice?`<p class="cart__goods-discount">${A(Math.round(Number(c.oldPrice)))} ₽</p>`:""}\n      <p class="cart__goods-credit">В кредит от 5600 ₽</p>\n    </div>\n  `);const v=document.createElement("button");return v.classList.add("cart__goods-delete","cart__delete-btn"),v.type="button",v.ariaLabel="Удалить товар",v.insertAdjacentHTML("beforeend",'\n    <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <g clip-path="url(#clip0_217_1895)">\n       <path d="M19.0214 5.35355L19.1679 5.5H19.375H23.25V7H6.75V5.5H10.625H10.8321L10.9786 5.35355L12.0821 4.25H17.9179L19.0214 5.35355ZM10 25.75C8.90114 25.75 8 24.8489 8 23.75V9.25H22V23.75C22 24.8489 21.0989 25.75 20 25.75H10Z" fill="currentColor" stroke="currentColor"/>\n      </g>\n      <defs>\n        <clipPath id="clip0_217_1895">\n          <rect width="30" height="30" fill="currentColor"/>\n        </clipPath>\n      </defs>\n    </svg>\n  '),s.append(v),s})(r,o,t,e,c,n,a)));$.append(...s)},X=()=>{const t=document.createElement("li");t.classList.add("cart__skeleton","cart__skeleton_item-skeleton");const e=document.createElement("div");e.classList.add("cart__skeleton","cart__skeleton_item-skeleton-body");const c=document.createElement("div");c.classList.add("cart__skeleton","cart__skeleton_item-skeleton-checkbox","skeleton");const n=document.createElement("div");n.classList.add("cart__skeleton","cart__skeleton_item-skeleton-image","skeleton");const a=document.createElement("div");a.classList.add("cart__skeleton","cart__skeleton_item-skeleton-info");const r=document.createElement("div");r.classList.add("cart__skeleton","cart__skeleton_item-skeleton-description","skeleton");const o=document.createElement("div");o.classList.add("cart__skeleton","cart__skeleton_item-skeleton-description","skeleton");const s=document.createElement("div");return s.classList.add("cart__skeleton","cart__skeleton_item-skeleton-price","skeleton"),a.append(r,o),e.append(c,n,a,s),t.append(e),t},tt=t=>{const e=document.createElement("ul");e.classList.add("cart__delivery-list");const c=t.map((t=>(t=>{const e=document.createElement("li");e.classList.add("cart__delivery-product"),e.setAttribute("data-productid",t.id);const c=document.createElement("a");return c.classList.add("cart__delivery-link","cart__img-container"),c.href="product.html",c.insertAdjacentHTML("beforeend",`\n    <picture>\n      <source srcset="${rt}${t.image}" type="image/avif">\n      <source srcset="${rt}${t.image}" type="image/webp">\n      <img class="cart__delivery-picture" src="${rt}${t.image}" alt="Изображение товара" width="80" height="80">\n    </picture>                \n  `),c.addEventListener("click",(()=>T(t.id))),e.append(c),e})(t)));e.append(...c),H.append(e)},et=t=>{S.firstElementChild.insertAdjacentHTML("beforeend",'\n    <button class="cart__change-delivery cart__text cart__text_weight_bold cart__text_color_blue" type="button">Изменить</button>  \n  '),H.insertAdjacentHTML("afterbegin",'\n    <p class="cart__delivery-point">Пункт выдачи</p>\n    <p class="cart__delivery-address cart__text cart__text_color_black">г. Москва (Московская область), улица Павлика Морозова, д. 48, (Пункт выдачи), Ежедневно 10:00-21:00</p>\n    <p class="cart__delivery-price">Стоимость доставки</p>\n    <p class="cart__delivery-cost cart__text cart__text_color_black">Бесплатно</p>             \n    <p class="cart__delivery-date cart__text cart__text_color_black cart__text_weight_bold">10-13 февраля</p>\n  '),tt(t)},ct=t=>{F();const e=t.cart.filter((t=>t.isCheckedForOrder));e.length||B();const{currentPrice:c,count:n,oldPrice:a,discount:r}={currentPrice:(o=e).reduce(((t,e)=>Number(e.price)*Number(e.count)+t),0),count:o.reduce(((t,e)=>Number(e.count)+t),0),oldPrice:o.reduce(((t,e)=>(e.oldPrice?Number(e.oldPrice)*Number(e.count):Number(e.price)*Number(e.count))+t),0),discount:o.reduce(((t,e)=>(e.oldPrice?(Number(e.oldPrice)-Number(e.price))*Number(e.count):0)+t),0)};var o;const s=document.createElement("div");s.classList.add("cart__total-top");const d=document.createElement("p");d.classList.add("cart__total-header"),d.innerText="Итого:";const i=document.createElement("p");i.classList.add("cart__total-cost"),i.textContent=A(c)+" ₽",s.append(d,i);const l=document.createElement("div");l.classList.add("cart__total-info");const _=document.createElement("div");_.classList.add("cart__flex","cart__flex_type_goods");const u=document.createElement("p");u.classList.add("cart__text","cart__text_content_goods-count"),u.textContent=`Товары, ${n}  шт.`;const p=document.createElement("p");p.classList.add("cart__text","cart__text_content_goods-cost"),p.textContent=`${A(a)} ₽`,_.append(u,p);const m=document.createElement("div");m.classList.add("cart__flex","cart__flex_type_discount");const b=document.createElement("p");b.classList.add("cart__text"),b.textContent="Скидка";const h=document.createElement("p");h.classList.add("cart__text","cart__text_content_discount-value"),h.textContent=`${A(r)} ₽`,m.append(b,h),l.append(_,m),l.insertAdjacentHTML("beforeend",'\n    <div class="cart__flex cart__total-delivery">\n      <p class="cart__text">Доставка</p>\n      <p class="cart__text">Бесплатно</p>\n    </div>\n  '),P.append(s,l),P.insertAdjacentHTML("beforeend",'\n    <div class="cart__total-point">\n      <div class="cart__flex cart__flex_type_late-flex">\n        <p class="cart__text cart__text_weight_bold cart__text_color_black">Доставка:</p>\n        <p class="cart__delivery-type cart__text cart__text_weight_bold cart__text_color_blue">Пункт выдачи</p>\n      </div>\n      <p class="cart__text">Ежедневно 10:00 - 21:00</p>\n      <p class="cart__text">г. Москва (Московская область), улица Павлика Морозова, д. 48</p>\n    </div>\n    <div class="cart__flex cart__flex_type_late-flex">\n      <p class="cart__text cart__text_weight_bold cart__text_color_black">Дата:</p>\n      <p class="cart__total-date cart__text cart__text_weight_bold cart__text_color_blue">10-13 февраля</p>\n    </div>\n    <div class="cart__flex cart__flex_type_late-flex">\n      <p class="cart__text cart__text_weight_bold cart__text_color_black">Оплата:</p>\n      <p class="cart__total-payment cart__text cart__text_weight_bold cart__text_color_blue">Картой</p>\n    </div>\n  ');const v=document.createElement("button");v.classList.add("cart__order-btn","button"),v.type="button",v.innerText="Заказать",P.append(v);const g=document.createElement("label");g.classList.add("cart__total-terms","cart__flex");const k=document.createElement("input");return k.classList.add("checkbox"),k.type="checkbox",k.checked=!0,k.addEventListener("change",(t=>{return e=t.target,(c=v).disabled=!e.checked,void(e.checked?e.checked&&c.classList.contains("button__disabled")&&c.classList.remove("button__disabled"):c.classList.add("button__disabled"));var e,c})),g.append(k),g.insertAdjacentHTML("beforeend",'\n    <span class="cart__text"><a href="#" class="cart__text cart__text_color_black cart__text_type_link">Согласен с условиями</a> правил пользования торговой площадкой и правилами возврата</span>\n  '),P.append(g),{topBlockCost:i,goodsCount:u,goodsCost:p,discountValue:h}},nt=()=>{(()=>{const t=[];for(let e=0;e<3;e++)t.push(X());$.append(...t)})(),(()=>{const t=document.createElement("div");t.classList.add("cart__skeleton","cart__skeleton_delivery-subtitle","cart__skeleton_delivery-subtitle_top","skeleton");const e=document.createElement("div");e.classList.add("cart__skeleton","cart__skeleton_delivery-subtitle","cart__skeleton_delivery-subtitle_bottom","skeleton");const c=document.createElement("div");c.classList.add("cart__skeleton","cart__skeleton_delivery-description","skeleton");const n=document.createElement("div");n.classList.add("cart__skeleton","cart__skeleton_delivery-gallery");const a=document.createElement("div");a.classList.add("cart__skeleton","cart__skeleton_delivery-picture","skeleton");const r=document.createElement("div");r.classList.add("cart__skeleton","cart__skeleton_delivery-picture","skeleton"),n.append(a,r),H.prepend(t,e,c,n)})(),(()=>{const t=document.createElement("div");t.classList.add("cart__skeleton","cart__skeleton_total");const e=document.createElement("div");e.classList.add("cart__skeleton","cart__skeleton_total-title","skeleton");const c=document.createElement("div");c.classList.add("cart__skeleton","cart__skeleton_total-info-top","skeleton");const n=document.createElement("div");n.classList.add("cart__skeleton","cart__skeleton_total-info-bottom","skeleton");const a=document.createElement("div");a.classList.add("cart__skeleton","cart__skeleton_total-button","skeleton"),t.append(e,c,n,a),M.append(t)})()},at=()=>{nt(),e(ot+"user",{callback:(t,e)=>{if(t)return console.warn(t),void alert("Произошла ошибка");if($.innerHTML="",H.innerHTML="",document.querySelector(".cart__skeleton_total").remove(),!e.cart.length)return void I();const{topBlockCost:c,goodsCount:n,goodsCost:a,discountValue:r}=ct(e);U(e.cart,c,n,a,r),et(e.cart),j(e.cart)}})},rt="https://comet-sphenoid-diamond.glitch.me/",ot=`${rt}api/`,st=window.location.pathname,dt=st.match(/index|catalog|product|cart/)?st.match(/index|catalog|product|cart/)[0]:"index";switch((()=>{(()=>{const t=_.map((t=>u(t,"header"))),e=_.map((t=>u(t,"footer")));i.append(...t),l.append(...e)})(),p(),n.addEventListener("click",(()=>{a.classList.toggle("header__button-icon_active"),r.classList.contains("header__menu-box_active")?(r.style.height="",r.classList.remove("header__menu-box_active"),o.style.opacity="0",setTimeout((()=>o.classList.remove("header__menu-overlay_active")),400)):(o.classList.add("header__menu-overlay_active"),o.style.opacity="1",r.style.height=`${r.scrollHeight}px`,r.classList.add("header__menu-box_active"))})),o.addEventListener("click",(t=>{(t.target===o||t.target.classList.contains("navigation-block__link"))&&(a.classList.remove("header__button-icon_active"),r.classList.remove("header__menu-box_active"),r.style.height="",setTimeout((()=>o.classList.remove("header__menu-overlay_active")),400))}));const t=document.querySelectorAll(".navigation-block__accordeon-btn"),e=document.querySelectorAll(".navigation-block__accordeon-arrow"),c=document.querySelectorAll(".navigation-block__list_position_footer");t.forEach(((t,n)=>{t.addEventListener("click",(()=>{e[n].classList.toggle("navigation-block__accordeon-arrow_active"),c[n].style.height=c[n].classList.contains("navigation-block__list_active")?"":`${c[n].scrollHeight}px`,c[n].classList.toggle("navigation-block__list_active")}))})),window.addEventListener("resize",(()=>{document.documentElement.scrollWidth>640&&(o.classList.remove("header__menu-overlay_active"),a.classList.remove("header__button-icon_active"),r.classList.remove("header__menu-box_active"),r.style.height="",c.forEach((t=>{t.classList.remove("navigation-block__list_active"),t.style.height=""})),e.forEach((t=>{t.classList.remove("navigation-block__accordeon-arrow_active")})))}))})(),dt){case"index":window.addEventListener("DOMContentLoaded",(()=>b("+03")));break;case"catalog":k();break;case"product":C();break;case"cart":at()}})();